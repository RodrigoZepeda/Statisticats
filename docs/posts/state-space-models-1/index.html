<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rodrigo Zepeda-Tello">

<title>Statisticats 🐱 - Modelos de Espacios de Estados</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sín resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la busqueda",
    "search-hide-matches-text": "Esconder resultados adicionales",
    "search-more-match-text": "hay más resultados en este documento",
    "search-more-matches-text": "más resultados en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Eviar"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Statisticats 🐱</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About | Acerca de</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/RodrigoZepeda/Statisticats"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/RodZepeda"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<p>suscribe.html</p>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#propiedades-probabilísticas" id="toc-propiedades-probabilísticas" class="nav-link" data-scroll-target="#propiedades-probabilísticas">Propiedades probabilísticas</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modelos de Espacios de Estados</h1>
  <div class="quarto-categories">
    <div class="quarto-category">modelos de espacios de estados / state space models</div>
    <div class="quarto-category">estadística / statistics</div>
    <div class="quarto-category">series de tiempo / time series</div>
    <div class="quarto-category">bayes</div>
    <div class="quarto-category">español / Spanish</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-contents">
             <p>Rodrigo Zepeda-Tello </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Fecha de Publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">8 de octubre de 2022</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Resumen</div>
    En esta entrada discutimos la definición de un <strong>modelo de espacio de estados</strong> así como algunas de sus propiedades matemáticas Finalmente utilizamos dichas propiedades para resolver analíticamente los tres problemas principales que abordan estos modelos: <strong>filtrado</strong>, <strong>suavizamiento</strong> y <strong>predicción</strong>.
  </div>
</div>

</header>

<div class="cell">

</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="sloyd_system.jpg" class="img-fluid figure-img" alt="Diagrama de 1892 que muestra diferentes formas de realizar cortes a madera."></p>
<p></p><figcaption class="figure-caption margin-caption">Fuente: <em>Internet Archive Book Images, No restrictions, via Wikimedia Commons</em></figcaption><p></p>
</figure>
</div>
<blockquote class="blockquote">
<p>Última actualización 2022-11-06</p>
</blockquote>
<section id="introducción" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>Un <strong>modelo de espacios de estados</strong> es un sistema que evoluciona con el tiempo compuesto por dos variables:</p>
<ul>
<li><p>Una variable <strong>observada</strong> <span class="math inline">\(y_t\)</span> que representa las mediciones realizadas al sistema al tiempo <span class="math inline">\(t\)</span>.</p></li>
<li><p>Una variable <strong>latente</strong> (o escondida) <span class="math inline">\(x_t\)</span> que es la que en realidad lleva la dinámica.</p></li>
</ul>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>A lo largo de estas notas consideraremos que el subíndice <span class="math inline">\(t\)</span> es un número entero mayor o igual a cero (<em>i.e.</em> discreto).</p>
</div>
</div>
<p>Si, por ejemplo, desde tierra observamos un avión navegar entre las nubes <span class="math inline">\(y_t\)</span> sería la posición del avión al tiempo <span class="math inline">\(t\)</span> (desde nuestra perspectiva) y <span class="math inline">\(x_t\)</span> sería la instrucción arrojada por el piloto que vuela el avión (al tiempo <span class="math inline">\(t\)</span>). Al piloto <span class="math inline">\(x_t\)</span> no lo vemos (<strong>latente</strong>) pero es quien en realidad controla la posición <strong>observada</strong> de la aeronave <span class="math inline">\(y_t\)</span>.</p>
<p>Una forma común de representar los modelos de espacios de estados es mediante gráficas acíclicas dirigidas (como en la <a href="#fig-dag-space-state">Figura&nbsp;1</a>) donde podemos observar que en cada momento <span class="math inline">\(t\)</span> la <span class="math inline">\(x_t\)</span> depende sólo de su posición anterior (<span class="math inline">\(x_{t-1}\)</span>). Éstas variables llevan la dinámica pues son las que evolucionan con el tiempo. Por otro lado, las variables observadas, <span class="math inline">\(y_t\)</span>, se originan por cada <span class="math inline">\(x_t\)</span> y por tanto en el diagrama éstas son completamente explicadas por su <span class="math inline">\(x_t\)</span> correspondiente.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-space-state" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="index_files/figure-html/fig-dag-space-state-1.png" class="img-fluid figure-img" alt="Diagrama de un modelo de espacios de estados. Comienza con un nodo x0 del lado izquierdo que se asocia con x1 mediante una flecha dirigida hacia éste. De x1 brotan dos flechas una hacia y1 en la parte inferior y una hacia x2 a su derecha. El proceso continúa hasta llegar a x subíndice t menos 1, x subíndice t y x subíndice t más 1 los cuales se conectan mediante flechas de izquierda a derecha partiendo de x subíndice t menos 1 rumbo a x subíndice t y de éste rumbo a x subíndice t más 1. Las y subíndice t (respectivamente subíndices t menos 1 y t más 1) están debajo de las x y se conectan con éstas mediante flechas que surgen de la respectiva x rumbo a la y correspondiente." width="768"></p>
<p></p><figcaption class="figure-caption margin-caption">Figura&nbsp;1: Representación diagramática de un modelo de espacio de estados. Las <span class="math inline">\(x_t\)</span> son las variables que llevan la dinámica y éstas generan los observables <span class="math inline">\(y_t\)</span>. Nota que las <span class="math inline">\(x_t\)</span> sólo dependen de la observación anterior.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Un ejemplo específico de un modelo de espacios de estados (el <strong>modelo local lineal</strong>) ocurre cuando consideramos que las variables latentes <span class="math inline">\(x_t\)</span> se generan a partir de la anterior (<span class="math inline">\(x_{t-1}\)</span>) más un error aleatorio (<em>i.e.</em> forman una caminata aleatoria):</p>
<p><span class="math display">\[
x_{t} = x_{t-1} + \eta_t \text{ con } \eta_t \sim \text{Normal}(0,\sigma_{\eta}^2)
\]</span></p>
<p>mientras que las <span class="math inline">\(y_t\)</span> están dadas por la <span class="math inline">\(x_t\)</span> más un segundo error aleatorio de medición con una distribución igualmente normal:</p>
<p><span class="math display">\[
y_t = x_t + \epsilon_t \text{ con } \epsilon_t \sim \text{Normal}(0,\sigma_{\epsilon}^2)
\]</span></p>
<p>El sistema completo está dado por:</p>
<p><span id="eq-local-linear-1"><span class="math display">\[
\begin{align}
x_t &amp; = x_{t-1} + \eta_t \\
y_t &amp; = x_t + \epsilon_t
\end{align}
\tag{1}\]</span></span></p>
<p>con <span class="math inline">\(\eta_t \sim \text{Normal}(0,\sigma_{\eta}^2)\)</span> y <span class="math inline">\(\epsilon_t \sim \text{Normal}(0,\sigma_{\epsilon}^2)\)</span>.</p>
<p>Una simulación de este proceso está dado por la <a href="#fig-simulations-local-linear-space-state">Figura&nbsp;2</a>:</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">475</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ntimes <span class="ot">&lt;-</span> <span class="dv">100</span>    <span class="co">#Número de simulaciones desde x0 hasta x_ntimes</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>xinit  <span class="ot">&lt;-</span> <span class="dv">0</span>      <span class="co">#Valor inicial de x</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sigma_eta <span class="ot">&lt;-</span> <span class="dv">1</span>   <span class="co">#Varianza de eta</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sigma_eps <span class="ot">&lt;-</span> <span class="fl">2.1</span> <span class="co">#Varianza de epsilon</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>xt     <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, ntimes <span class="sc">+</span> <span class="dv">1</span>); xt[<span class="dv">1</span>] <span class="ot">&lt;-</span> xinit</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>etat   <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, ntimes)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>yt     <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, ntimes)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>epst   <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, ntimes)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (tval <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ntimes){</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  etat[tval]     <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_eta)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  xt[tval <span class="sc">+</span> <span class="dv">1</span>]   <span class="ot">&lt;-</span> xt[tval] <span class="sc">+</span> etat[tval]</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  epst[tval]     <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_eps)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  yt[tval]       <span class="ot">&lt;-</span> xt[tval <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">+</span> epst[tval]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>mynames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">xt</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">TeX</span>(<span class="st">"$x_t$"</span>),</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">etat</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">eta_t$"</span>),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">yt</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">TeX</span>(<span class="st">"$y_t$"</span>),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">epst</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">epsilon_t$"</span>))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Realineación de x</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> <span class="dv">1</span><span class="sc">:</span>ntimes,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">xt   =</span> xt[<span class="dv">2</span><span class="sc">:</span>(ntimes <span class="sc">+</span> <span class="dv">1</span>)],</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">yt   =</span> yt, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">epst =</span> epst,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">etat =</span> etat,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> xt<span class="sc">:</span>etat) <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">names</span>(mynames), </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> mynames, <span class="at">ordered =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, <span class="at">color =</span> name), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">labeller =</span> label_parsed) <span class="sc">+</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y     =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y    =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">color =</span> <span class="st">"#0077a1"</span>, </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle   =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">"gray25"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">""</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1b7385"</span>,<span class="st">"#3076b8"</span>, <span class="st">"#a662bd"</span>,<span class="st">"#f53d7a"</span>)) <span class="sc">+</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">x        =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">Tiempo (t)"</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">y        =</span> <span class="st">""</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Simulaciones de un modelo a nivel local"</span>,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Local level model"</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption  =</span> <span class="st">"@RodZepeda"</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-simulations-local-linear-space-state" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="index_files/figure-html/fig-simulations-local-linear-space-state-1.png" class="img-fluid figure-img" alt="Gráfica que muestra una caminata aleatoria para x subíndice t, una caminata aleatoria para y subíndice t y los errores epsilon y eta t simulados mediante normales" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Figura&nbsp;2: Simulación del modelo de espacios de estados lineal dado por <span class="math inline">\(x_t = x_{t-1} + \eta_t\)</span> y <span class="math inline">\(y_t = x_t + \epsilon_t\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>En general, la relación entre las variables observadas y latentes no tiene por qué ser lineal como en <a href="#eq-local-linear-1">la ecuación&nbsp;1</a> y podemos denotar un modelo de espacios de estados como:</p>
<p><span id="eq-space-state-model"><span class="math display">\[
\begin{align}
x_t &amp; = f(x_{t-1}, \eta_t), \\
y_t &amp; = h(x_t, \epsilon_t),
\end{align}
\tag{2}\]</span></span></p>
<p>con <span class="math inline">\(\eta_t\)</span>, <span class="math inline">\(\epsilon_t\)</span> los correspondientes “ruidos” del sistema y de medición (<span class="math inline">\(\{\eta_t\}_{t\geq0}\)</span> y <span class="math inline">\(\{\epsilon_t\}_{t\geq0}\)</span> son colecciones de variables aleatorias mutuamente independientes). En general tanto <span class="math inline">\(f\)</span> como <span class="math inline">\(h\)</span> son desconocidas y no lineales.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</section>
<section id="propiedades-probabilísticas" class="level2">
<h2 class="anchored" data-anchor-id="propiedades-probabilísticas">Propiedades probabilísticas</h2>
<p>En términos de probabilidad el sistema propone un <strong>sistema markoviano</strong> (nota que <span class="math inline">\(x_t\)</span> sólo depende de <span class="math inline">\(x_{t-1}\)</span>) que puede escribirse como sigue:</p>
<p><span id="eq-space-state-model-proba"><span class="math display">\[
\begin{align}
x_t &amp; \sim p(x_{t}|x_{t-1}), \\
y_t &amp; \sim p(y_t | x_t),
\end{align}
\tag{3}\]</span></span></p>
<p>con <span class="math inline">\(t\geq 1\)</span>. A <span class="math inline">\(p(x_{t}|x_{t-1})\)</span> se le conoce como el <strong>modelo dinámico</strong> mientras que <span class="math inline">\(p(y_t | x_t)\)</span> corresponde al <strong>modelo de medición</strong>. Por definición (y un poco por inspiración del diagrama) se cumple <strong>la propiedad de Markov (discreta) para los estados</strong> <span class="math inline">\(x_t\)</span>:</p>
<p><span id="eq-space-state-model-markov"><span class="math display">\[
p(x_t | x_{0:t−1}, y_{1:t−1}) = p(x_t | x_{t−1}),
\tag{4}\]</span></span></p>
<p>así como <strong>la independencia condicional de las observaciones</strong>:</p>
<p><span id="eq-space-state-model-conditional-independence-obs"><span class="math display">\[
p(y_t | x_{0:t}, y_{1:t−1}) = p(y_t | x_{t}).
\tag{5}\]</span></span></p>
<p>En estas ecuaciones, la notación <span class="math inline">\(v_{t-k:t+\ell}\)</span> para <span class="math inline">\(k,\ell\)</span> números naturales representa un vector con entradas de la colección <span class="math inline">\(\{v_t\}_{t\geq 0}\)</span> tomadas desde <span class="math inline">\(v_{t-k}\)</span> hasta <span class="math inline">\(v_{t + \ell}\)</span>:</p>
<p><span class="math display">\[
x_{t-k:t+\ell} = (x_{t-k}, x_{t-k + 1}, \dots, x_{t + \ell - 1}, x_{t+ \ell})^T.
\]</span></p>
<p>La distribución conjunta de los estados al momento <span class="math inline">\(T\)</span> puede obtenerse fácilmente a partir de Markov (<a href="#eq-space-state-model-markov">la ecuación&nbsp;4</a>):</p>
<p><span id="eq-markov-space-state-x0T"><span class="math display">\[
p(x_{0:T}) = p(x_0) \prod_{t = 1}^T p(x_t|x_{t-1}).
\tag{6}\]</span></span></p>
<p>Mientras que la independencia condicional de las observaciones implica también un producto para el vector de estados <span class="math inline">\(y_{1:T}\)</span>:</p>
<p><span id="eq-markov-space-state-y0T-condicional-x0T"><span class="math display">\[
p(y_{1:T} | x_{0:T} ) = \prod\limits_{t = 1}^T p(y_t|x_t)
\tag{7}\]</span></span></p>
<p>Una simple aplicación de bayes permite la estimación de los estados a partir de las observaciones y la combinación de <a href="#eq-markov-space-state-x0T">la ecuación&nbsp;6</a> y <a href="#eq-markov-space-state-y0T-condicional-x0T">la ecuación&nbsp;7</a>:</p>
<p><span class="math display">\[
p(x_{0:T} | y_{1:T} ) \propto p(y_{1:T} | x_{0:T} ) \cdot p(x_{0:T})
\]</span></p>
<p>Hay tres distribuciones que son de importancia en el contexto de modelos de espacios de estados que pueden verse en la <a href="#tbl-distribuciones-espacio-estados-clasificacion">Tabla&nbsp;1</a>:</p>
<div id="tbl-distribuciones-espacio-estados-clasificacion" class="anchored">
<table class="table">
<caption>Tabla&nbsp;1: Distribuciones de importancia para modelos de espacios de estados</caption>
<thead>
<tr class="header">
<th>Nombre</th>
<th>Distribución</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Filtro</td>
<td><span class="math inline">\(p(x_t|y_{1:t})\)</span></td>
</tr>
<tr class="even">
<td>Suavizamiento</td>
<td><span class="math inline">\(p(x_{t-\ell}|y_{1:t})\)</span> con <span class="math inline">\(\ell \geq 0\)</span></td>
</tr>
<tr class="odd">
<td>Predicción</td>
<td><span class="math inline">\(p(x_{t+\ell}|y_{1:t})\)</span> con <span class="math inline">\(\ell \geq 1\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>A continuación derivamos las distribuciones de cada uno de estos escenarios a partir de las propiedades de los modelos de espacios de estados.</p>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Notas</h2>

<ol>
<li id="fn1"><p>Aún más general, tanto <span class="math inline">\(f\)</span> como <span class="math inline">\(h\)</span> podrían ser funciones que dependieran explícitamente del tiempo: <span class="math inline">\(x_t = f_t(x_{t-1}, \eta_t)\)</span> y <span class="math inline">\(y_t = h_t(x_t,\epsilon_t)\)</span>. No consideraré este caso pues se puede trabajar con una variable <span class="math inline">\(x_t\)</span> ampliada dada por <span class="math inline">\(x^{\circ}_t := (t, x_t)^T\)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="RodZepeda/StatisticatsComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>