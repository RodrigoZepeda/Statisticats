<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Statisticats 🐱</title>
<link>https://rodrigozepeda.github.io/Statisticats/index.html</link>
<atom:link href="https://rodrigozepeda.github.io/Statisticats/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.1.251</generator>
<lastBuildDate>Sat, 08 Oct 2022 05:00:00 GMT</lastBuildDate>
<item>
  <title>Modelos de Espacios de Estados</title>
  <dc:creator>Rodrigo Zepeda-Tello</dc:creator>
  <link>https://rodrigozepeda.github.io/Statisticats/posts/state-space-models-1/index.html</link>
  <description><![CDATA[ 



<div class="cell">

</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://rodrigozepeda.github.io/Statisticats/posts/state-space-models-1/sloyd_system.jpg" class="img-fluid figure-img" alt="Diagrama de 1892 que muestra diferentes formas de realizar cortes a madera."></p>
<p></p><figcaption class="figure-caption margin-caption">Fuente: <em>Internet Archive Book Images, No restrictions, via Wikimedia Commons</em></figcaption><p></p>
</figure>
</div>
<blockquote class="blockquote">
<p>Última actualización 2022-11-06</p>
</blockquote>
<section id="introducción" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>Un <strong>modelo de espacios de estados</strong> es un sistema que evoluciona con el tiempo compuesto por dos variables:</p>
<ul>
<li><p>Una variable <strong>observada</strong> <img src="https://latex.codecogs.com/png.latex?y_t"> que representa las mediciones realizadas al sistema al tiempo <img src="https://latex.codecogs.com/png.latex?t">.</p></li>
<li><p>Una variable <strong>latente</strong> (o escondida) <img src="https://latex.codecogs.com/png.latex?x_t"> que es la que en realidad lleva la dinámica.</p></li>
</ul>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>A lo largo de estas notas consideraremos que el subíndice <img src="https://latex.codecogs.com/png.latex?t"> es un número entero mayor o igual a cero (<em>i.e.</em> discreto).</p>
</div>
</div>
<p>Si, por ejemplo, desde tierra observamos un avión navegar entre las nubes <img src="https://latex.codecogs.com/png.latex?y_t"> sería la posición del avión al tiempo <img src="https://latex.codecogs.com/png.latex?t"> (desde nuestra perspectiva) y <img src="https://latex.codecogs.com/png.latex?x_t"> sería la instrucción arrojada por el piloto que vuela el avión (al tiempo <img src="https://latex.codecogs.com/png.latex?t">). Al piloto <img src="https://latex.codecogs.com/png.latex?x_t"> no lo vemos (<strong>latente</strong>) pero es quien en realidad controla la posición <strong>observada</strong> de la aeronave <img src="https://latex.codecogs.com/png.latex?y_t">.</p>
<p>Una forma común de representar los modelos de espacios de estados es mediante gráficas acíclicas dirigidas (como en la Figura&nbsp;1) donde podemos observar que en cada momento <img src="https://latex.codecogs.com/png.latex?t"> la <img src="https://latex.codecogs.com/png.latex?x_t"> depende sólo de su posición anterior (<img src="https://latex.codecogs.com/png.latex?x_%7Bt-1%7D">). Éstas variables llevan la dinámica pues son las que evolucionan con el tiempo. Por otro lado, las variables observadas, <img src="https://latex.codecogs.com/png.latex?y_t">, se originan por cada <img src="https://latex.codecogs.com/png.latex?x_t"> y por tanto en el diagrama éstas son completamente explicadas por su <img src="https://latex.codecogs.com/png.latex?x_t"> correspondiente.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-dag-space-state" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://rodrigozepeda.github.io/Statisticats/posts/state-space-models-1/index_files/figure-html/fig-dag-space-state-1.png" class="img-fluid figure-img" alt="Diagrama de un modelo de espacios de estados. Comienza con un nodo x0 del lado izquierdo que se asocia con x1 mediante una flecha dirigida hacia éste. De x1 brotan dos flechas una hacia y1 en la parte inferior y una hacia x2 a su derecha. El proceso continúa hasta llegar a x subíndice t menos 1, x subíndice t y x subíndice t más 1 los cuales se conectan mediante flechas de izquierda a derecha partiendo de x subíndice t menos 1 rumbo a x subíndice t y de éste rumbo a x subíndice t más 1. Las y subíndice t (respectivamente subíndices t menos 1 y t más 1) están debajo de las x y se conectan con éstas mediante flechas que surgen de la respectiva x rumbo a la y correspondiente." width="768"></p>
<p></p><figcaption class="figure-caption margin-caption">Figura&nbsp;1: Representación diagramática de un modelo de espacio de estados. Las <img src="https://latex.codecogs.com/png.latex?x_t"> son las variables que llevan la dinámica y éstas generan los observables <img src="https://latex.codecogs.com/png.latex?y_t">. Nota que las <img src="https://latex.codecogs.com/png.latex?x_t"> sólo dependen de la observación anterior.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Un ejemplo específico de un modelo de espacios de estados (el <strong>modelo local lineal</strong>) ocurre cuando consideramos que las variables latentes <img src="https://latex.codecogs.com/png.latex?x_t"> se generan a partir de la anterior (<img src="https://latex.codecogs.com/png.latex?x_%7Bt-1%7D">) más un error aleatorio (<em>i.e.</em> forman una caminata aleatoria):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_%7Bt%7D%20=%20x_%7Bt-1%7D%20+%20%5Ceta_t%20%5Ctext%7B%20con%20%7D%20%5Ceta_t%20%5Csim%20%5Ctext%7BNormal%7D(0,%5Csigma_%7B%5Ceta%7D%5E2)%0A"></p>
<p>mientras que las <img src="https://latex.codecogs.com/png.latex?y_t"> están dadas por la <img src="https://latex.codecogs.com/png.latex?x_t"> más un segundo error aleatorio de medición con una distribución igualmente normal:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ay_t%20=%20x_t%20+%20%5Cepsilon_t%20%5Ctext%7B%20con%20%7D%20%5Cepsilon_t%20%5Csim%20%5Ctext%7BNormal%7D(0,%5Csigma_%7B%5Cepsilon%7D%5E2)%0A"></p>
<p>El sistema completo está dado por:</p>
<p><span id="eq-local-linear-1"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Ax_t%20&amp;%20=%20x_%7Bt-1%7D%20+%20%5Ceta_t%20%5C%5C%0Ay_t%20&amp;%20=%20x_t%20+%20%5Cepsilon_t%0A%5Cend%7Balign%7D%0A%5Ctag%7B1%7D"></span></p>
<p>con <img src="https://latex.codecogs.com/png.latex?%5Ceta_t%20%5Csim%20%5Ctext%7BNormal%7D(0,%5Csigma_%7B%5Ceta%7D%5E2)"> y <img src="https://latex.codecogs.com/png.latex?%5Cepsilon_t%20%5Csim%20%5Ctext%7BNormal%7D(0,%5Csigma_%7B%5Cepsilon%7D%5E2)">.</p>
<p>Una simulación de este proceso está dado por la Figura&nbsp;2:</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">set.seed</span>(<span class="dv" style="color: #AD0000;">475</span>)</span>
<span id="cb1-2">ntimes <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">100</span>    <span class="co" style="color: #5E5E5E;">#Número de simulaciones desde x0 hasta x_ntimes</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">xinit  <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">0</span>      <span class="co" style="color: #5E5E5E;">#Valor inicial de x</span></span>
<span id="cb1-5">sigma_eta <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">1</span>   <span class="co" style="color: #5E5E5E;">#Varianza de eta</span></span>
<span id="cb1-6">sigma_eps <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fl" style="color: #AD0000;">2.1</span> <span class="co" style="color: #5E5E5E;">#Varianza de epsilon</span></span>
<span id="cb1-7"></span>
<span id="cb1-8">xt     <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rep</span>(<span class="cn" style="color: #8f5902;">NA</span>, ntimes <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span>); xt[<span class="dv" style="color: #AD0000;">1</span>] <span class="ot" style="color: #003B4F;">&lt;-</span> xinit</span>
<span id="cb1-9">etat   <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rep</span>(<span class="cn" style="color: #8f5902;">NA</span>, ntimes)</span>
<span id="cb1-10">yt     <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rep</span>(<span class="cn" style="color: #8f5902;">NA</span>, ntimes)</span>
<span id="cb1-11">epst   <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rep</span>(<span class="cn" style="color: #8f5902;">NA</span>, ntimes)</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="cf" style="color: #003B4F;">for</span> (tval <span class="cf" style="color: #003B4F;">in</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>ntimes){</span>
<span id="cb1-14">  etat[tval]     <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rnorm</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">mean =</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="at" style="color: #657422;">sd =</span> sigma_eta)</span>
<span id="cb1-15">  xt[tval <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span>]   <span class="ot" style="color: #003B4F;">&lt;-</span> xt[tval] <span class="sc" style="color: #5E5E5E;">+</span> etat[tval]</span>
<span id="cb1-16">  epst[tval]     <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">rnorm</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">mean =</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="at" style="color: #657422;">sd =</span> sigma_eps)</span>
<span id="cb1-17">  yt[tval]       <span class="ot" style="color: #003B4F;">&lt;-</span> xt[tval <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span>] <span class="sc" style="color: #5E5E5E;">+</span> epst[tval]</span>
<span id="cb1-18">}</span>
<span id="cb1-19"></span>
<span id="cb1-20">mynames <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">xt</span><span class="st" style="color: #20794D;">`</span>   <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">TeX</span>(<span class="st" style="color: #20794D;">"$x_t$"</span>),</span>
<span id="cb1-21">             <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">etat</span><span class="st" style="color: #20794D;">`</span> <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">TeX</span>(<span class="st" style="color: #20794D;">"$</span><span class="sc" style="color: #5E5E5E;">\\</span><span class="st" style="color: #20794D;">eta_t$"</span>),</span>
<span id="cb1-22">             <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">yt</span><span class="st" style="color: #20794D;">`</span>   <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">TeX</span>(<span class="st" style="color: #20794D;">"$y_t$"</span>),</span>
<span id="cb1-23">             <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">epst</span><span class="st" style="color: #20794D;">`</span> <span class="ot" style="color: #003B4F;">=</span> <span class="fu" style="color: #4758AB;">TeX</span>(<span class="st" style="color: #20794D;">"$</span><span class="sc" style="color: #5E5E5E;">\\</span><span class="st" style="color: #20794D;">epsilon_t$"</span>))</span>
<span id="cb1-24">  </span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;">#Realineación de x</span></span>
<span id="cb1-26"><span class="fu" style="color: #4758AB;">tibble</span>(</span>
<span id="cb1-27">  <span class="at" style="color: #657422;">time =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>ntimes,</span>
<span id="cb1-28">  <span class="at" style="color: #657422;">xt   =</span> xt[<span class="dv" style="color: #AD0000;">2</span><span class="sc" style="color: #5E5E5E;">:</span>(ntimes <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">1</span>)],</span>
<span id="cb1-29">  <span class="at" style="color: #657422;">yt   =</span> yt, </span>
<span id="cb1-30">  <span class="at" style="color: #657422;">epst =</span> epst,</span>
<span id="cb1-31">  <span class="at" style="color: #657422;">etat =</span> etat,</span>
<span id="cb1-32">) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-33">  <span class="fu" style="color: #4758AB;">pivot_longer</span>(<span class="at" style="color: #657422;">cols =</span> xt<span class="sc" style="color: #5E5E5E;">:</span>etat) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-34">  <span class="fu" style="color: #4758AB;">mutate</span>(<span class="at" style="color: #657422;">name =</span> <span class="fu" style="color: #4758AB;">factor</span>(name, <span class="at" style="color: #657422;">levels =</span> <span class="fu" style="color: #4758AB;">names</span>(mynames), </span>
<span id="cb1-35">                       <span class="at" style="color: #657422;">labels =</span> mynames, <span class="at" style="color: #657422;">ordered =</span> T)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb1-36">  <span class="fu" style="color: #4758AB;">ggplot</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-37">  <span class="fu" style="color: #4758AB;">geom_line</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> time, <span class="at" style="color: #657422;">y =</span> value, <span class="at" style="color: #657422;">color =</span> name)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;">geom_point</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> time, <span class="at" style="color: #657422;">y =</span> value, <span class="at" style="color: #657422;">color =</span> name), <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">1</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;">geom_point</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">x =</span> time, <span class="at" style="color: #657422;">y =</span> value), <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"white"</span>, <span class="at" style="color: #657422;">size =</span> <span class="fl" style="color: #AD0000;">0.25</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-40">  <span class="fu" style="color: #4758AB;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;">~</span>name, <span class="at" style="color: #657422;">labeller =</span> label_parsed) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-41">  <span class="fu" style="color: #4758AB;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-42">  <span class="fu" style="color: #4758AB;">theme</span>(</span>
<span id="cb1-43">    <span class="at" style="color: #657422;">legend.position =</span> <span class="st" style="color: #20794D;">"none"</span>,</span>
<span id="cb1-44">    <span class="at" style="color: #657422;">axis.text.y     =</span> <span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-45">    <span class="at" style="color: #657422;">axis.ticks.y    =</span> <span class="fu" style="color: #4758AB;">element_blank</span>(),</span>
<span id="cb1-46">    <span class="at" style="color: #657422;">plot.title      =</span> <span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">16</span>, <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"#0077a1"</span>, </span>
<span id="cb1-47">                                   <span class="at" style="color: #657422;">face =</span> <span class="st" style="color: #20794D;">"bold"</span>, <span class="at" style="color: #657422;">hjust =</span> <span class="fl" style="color: #AD0000;">0.5</span>),</span>
<span id="cb1-48">    <span class="at" style="color: #657422;">plot.subtitle   =</span> <span class="fu" style="color: #4758AB;">element_text</span>(<span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">12</span>, <span class="at" style="color: #657422;">face =</span> <span class="st" style="color: #20794D;">"italic"</span>,</span>
<span id="cb1-49">                                 <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"gray25"</span>, <span class="at" style="color: #657422;">hjust =</span> <span class="fl" style="color: #AD0000;">0.5</span>)</span>
<span id="cb1-50">  ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-51">  <span class="fu" style="color: #4758AB;">scale_color_manual</span>(<span class="st" style="color: #20794D;">""</span>, <span class="at" style="color: #657422;">values =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"#1b7385"</span>,<span class="st" style="color: #20794D;">"#3076b8"</span>, <span class="st" style="color: #20794D;">"#a662bd"</span>,<span class="st" style="color: #20794D;">"#f53d7a"</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb1-52">  <span class="fu" style="color: #4758AB;">labs</span>(</span>
<span id="cb1-53">    <span class="at" style="color: #657422;">x        =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">Tiempo (t)"</span>,</span>
<span id="cb1-54">    <span class="at" style="color: #657422;">y        =</span> <span class="st" style="color: #20794D;">""</span>,</span>
<span id="cb1-55">    <span class="at" style="color: #657422;">title    =</span> <span class="st" style="color: #20794D;">"Simulaciones de un modelo a nivel local"</span>,</span>
<span id="cb1-56">    <span class="at" style="color: #657422;">subtitle =</span> <span class="st" style="color: #20794D;">"Local level model"</span>,</span>
<span id="cb1-57">    <span class="at" style="color: #657422;">caption  =</span> <span class="st" style="color: #20794D;">"@RodZepeda"</span></span>
<span id="cb1-58">  ) </span></code></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div id="fig-simulations-local-linear-space-state" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="https://rodrigozepeda.github.io/Statisticats/posts/state-space-models-1/index_files/figure-html/fig-simulations-local-linear-space-state-1.png" class="img-fluid figure-img" alt="Gráfica que muestra una caminata aleatoria para x subíndice t, una caminata aleatoria para y subíndice t y los errores epsilon y eta t simulados mediante normales" width="672"></p>
<p></p><figcaption class="figure-caption margin-caption">Figura&nbsp;2: Simulación del modelo de espacios de estados lineal dado por <img src="https://latex.codecogs.com/png.latex?x_t%20=%20x_%7Bt-1%7D%20+%20%5Ceta_t"> y <img src="https://latex.codecogs.com/png.latex?y_t%20=%20x_t%20+%20%5Cepsilon_t"></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>En general, la relación entre las variables observadas y latentes no tiene por qué ser lineal como en la ecuación&nbsp;1 y podemos denotar un modelo de espacios de estados como:</p>
<p><span id="eq-space-state-model"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Ax_t%20&amp;%20=%20f(x_%7Bt-1%7D,%20%5Ceta_t),%20%5C%5C%0Ay_t%20&amp;%20=%20h(x_t,%20%5Cepsilon_t),%0A%5Cend%7Balign%7D%0A%5Ctag%7B2%7D"></span></p>
<p>con <img src="https://latex.codecogs.com/png.latex?%5Ceta_t">, <img src="https://latex.codecogs.com/png.latex?%5Cepsilon_t"> los correspondientes “ruidos” del sistema y de medición (<img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ceta_t%5C%7D_%7Bt%5Cgeq0%7D"> y <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cepsilon_t%5C%7D_%7Bt%5Cgeq0%7D"> son colecciones de variables aleatorias mutuamente independientes). En general tanto <img src="https://latex.codecogs.com/png.latex?f"> como <img src="https://latex.codecogs.com/png.latex?h"> son desconocidas y no lineales.<sup>1</sup></p>
</section>
<section id="propiedades-probabilísticas" class="level2">
<h2 class="anchored" data-anchor-id="propiedades-probabilísticas">Propiedades probabilísticas</h2>
<p>En términos de probabilidad el sistema propone un <strong>sistema markoviano</strong> (nota que <img src="https://latex.codecogs.com/png.latex?x_t"> sólo depende de <img src="https://latex.codecogs.com/png.latex?x_%7Bt-1%7D">) que puede escribirse como sigue:</p>
<p><span id="eq-space-state-model-proba"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Ax_t%20&amp;%20%5Csim%20p(x_%7Bt%7D%7Cx_%7Bt-1%7D),%20%5C%5C%0Ay_t%20&amp;%20%5Csim%20p(y_t%20%7C%20x_t),%0A%5Cend%7Balign%7D%0A%5Ctag%7B3%7D"></span></p>
<p>con <img src="https://latex.codecogs.com/png.latex?t%5Cgeq%201">. A <img src="https://latex.codecogs.com/png.latex?p(x_%7Bt%7D%7Cx_%7Bt-1%7D)"> se le conoce como el <strong>modelo dinámico</strong> mientras que <img src="https://latex.codecogs.com/png.latex?p(y_t%20%7C%20x_t)"> corresponde al <strong>modelo de medición</strong>. Por definición (y un poco por inspiración del diagrama) se cumple <strong>la propiedad de Markov (discreta) para los estados</strong> <img src="https://latex.codecogs.com/png.latex?x_t">:</p>
<p><span id="eq-space-state-model-markov"><img src="https://latex.codecogs.com/png.latex?%0Ap(x_t%20%7C%20x_%7B0:t%E2%88%921%7D,%20y_%7B1:t%E2%88%921%7D)%20=%20p(x_t%20%7C%20x_%7Bt%E2%88%921%7D),%0A%5Ctag%7B4%7D"></span></p>
<p>así como <strong>la independencia condicional de las observaciones</strong>:</p>
<p><span id="eq-space-state-model-conditional-independence-obs"><img src="https://latex.codecogs.com/png.latex?%0Ap(y_t%20%7C%20x_%7B0:t%7D,%20y_%7B1:t%E2%88%921%7D)%20=%20p(y_t%20%7C%20x_%7Bt%7D).%0A%5Ctag%7B5%7D"></span></p>
<p>En estas ecuaciones, la notación <img src="https://latex.codecogs.com/png.latex?v_%7Bt-k:t+%5Cell%7D"> para <img src="https://latex.codecogs.com/png.latex?k,%5Cell"> números naturales representa un vector con entradas de la colección <img src="https://latex.codecogs.com/png.latex?%5C%7Bv_t%5C%7D_%7Bt%5Cgeq%200%7D"> tomadas desde <img src="https://latex.codecogs.com/png.latex?v_%7Bt-k%7D"> hasta <img src="https://latex.codecogs.com/png.latex?v_%7Bt%20+%20%5Cell%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_%7Bt-k:t+%5Cell%7D%20=%20(x_%7Bt-k%7D,%20x_%7Bt-k%20+%201%7D,%20%5Cdots,%20x_%7Bt%20+%20%5Cell%20-%201%7D,%20x_%7Bt+%20%5Cell%7D)%5ET.%0A"></p>
<p>La distribución conjunta de los estados al momento <img src="https://latex.codecogs.com/png.latex?T"> puede obtenerse fácilmente a partir de Markov (la ecuación&nbsp;4):</p>
<p><span id="eq-markov-space-state-x0T"><img src="https://latex.codecogs.com/png.latex?%0Ap(x_%7B0:T%7D)%20=%20p(x_0)%20%5Cprod_%7Bt%20=%201%7D%5ET%20p(x_t%7Cx_%7Bt-1%7D).%0A%5Ctag%7B6%7D"></span></p>
<p>Mientras que la independencia condicional de las observaciones implica también un producto para el vector de estados <img src="https://latex.codecogs.com/png.latex?y_%7B1:T%7D">:</p>
<p><span id="eq-markov-space-state-y0T-condicional-x0T"><img src="https://latex.codecogs.com/png.latex?%0Ap(y_%7B1:T%7D%20%7C%20x_%7B0:T%7D%20)%20=%20%5Cprod%5Climits_%7Bt%20=%201%7D%5ET%20p(y_t%7Cx_t)%0A%5Ctag%7B7%7D"></span></p>
<p>Una simple aplicación de bayes permite la estimación de los estados a partir de las observaciones y la combinación de la ecuación&nbsp;6 y la ecuación&nbsp;7:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(x_%7B0:T%7D%20%7C%20y_%7B1:T%7D%20)%20%5Cpropto%20p(y_%7B1:T%7D%20%7C%20x_%7B0:T%7D%20)%20%5Ccdot%20p(x_%7B0:T%7D)%0A"></p>
<p>Hay tres distribuciones que son de importancia en el contexto de modelos de espacios de estados que pueden verse en la Tabla&nbsp;1:</p>
<div id="tbl-distribuciones-espacio-estados-clasificacion" class="anchored">
<table class="table">
<caption>Tabla&nbsp;1: Distribuciones de importancia para modelos de espacios de estados</caption>
<thead>
<tr class="header">
<th>Nombre</th>
<th>Distribución</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Filtro</td>
<td><img src="https://latex.codecogs.com/png.latex?p(x_t%7Cy_%7B1:t%7D)"></td>
</tr>
<tr class="even">
<td>Suavizamiento</td>
<td><img src="https://latex.codecogs.com/png.latex?p(x_%7Bt-%5Cell%7D%7Cy_%7B1:t%7D)"> con <img src="https://latex.codecogs.com/png.latex?%5Cell%20%5Cgeq%200"></td>
</tr>
<tr class="odd">
<td>Predicción</td>
<td><img src="https://latex.codecogs.com/png.latex?p(x_%7Bt+%5Cell%7D%7Cy_%7B1:t%7D)"> con <img src="https://latex.codecogs.com/png.latex?%5Cell%20%5Cgeq%201"></td>
</tr>
</tbody>
</table>
</div>
<p>A continuación derivamos las distribuciones de cada uno de estos escenarios a partir de las propiedades de los modelos de espacios de estados.</p>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Notas</h2>

<ol>
<li id="fn1"><p>Aún más general, tanto <img src="https://latex.codecogs.com/png.latex?f"> como <img src="https://latex.codecogs.com/png.latex?h"> podrían ser funciones que dependieran explícitamente del tiempo: <img src="https://latex.codecogs.com/png.latex?x_t%20=%20f_t(x_%7Bt-1%7D,%20%5Ceta_t)"> y <img src="https://latex.codecogs.com/png.latex?y_t%20=%20h_t(x_t,%5Cepsilon_t)">. No consideraré este caso pues se puede trabajar con una variable <img src="https://latex.codecogs.com/png.latex?x_t"> ampliada dada por <img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Ccirc%7D_t%20:=%20(t,%20x_t)%5ET">↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>modelos de espacios de estados / state space models</category>
  <category>estadística / statistics</category>
  <category>series de tiempo / time series</category>
  <category>bayes</category>
  <category>español / Spanish</category>
  <guid>https://rodrigozepeda.github.io/Statisticats/posts/state-space-models-1/index.html</guid>
  <pubDate>Sat, 08 Oct 2022 05:00:00 GMT</pubDate>
  <media:content url="https://rodrigozepeda.github.io/Statisticats/posts/state-space-models-1/sloyd_system.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
