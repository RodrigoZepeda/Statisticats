[
  {
    "objectID": "posts/state-space-models-1/index.html",
    "href": "posts/state-space-models-1/index.html",
    "title": "Modelos de Espacios de Estados",
    "section": "",
    "text": "Fuente: Internet Archive Book Images, No restrictions, via Wikimedia Commons\n\n\n\n√öltima actualizaci√≥n 2022-10-10\n\n\nIntroducci√≥n\nUn modelo de espacios de estados es un sistema que evoluciona con el tiempo compuesto por dos variables:\n\nUna variable observada \\(y_t\\) que representa las mediciones realizadas al sistema al tiempo \\(t\\).\nUna variable latente (o escondida) \\(x_t\\) que es la que en realidad lleva la din√°mica.\n\n\n\n\n\n\n\nNota\n\n\n\nA lo largo de estas notas consideraremos que el sub√≠ndice \\(t\\) es un n√∫mero entero mayor o igual a cero (i.e. discreto).\n\n\nSi, por ejemplo, desde tierra observamos un avi√≥n navegar entre las nubes \\(y_t\\) ser√≠a la posici√≥n del avi√≥n al tiempo \\(t\\) (desde nuestra perspectiva) y \\(x_t\\) ser√≠a la instrucci√≥n arrojada por el piloto que vuela el avi√≥n (al tiempo \\(t\\)). Al piloto \\(x_t\\) no lo vemos (latente) pero es quien en realidad controla la posici√≥n observada de la aeronave \\(y_t\\).\nUna forma com√∫n de representar los modelos de espacios de estados es mediante gr√°ficas ac√≠clicas dirigidas (como en la Figura¬†1) donde podemos observar que en cada momento \\(t\\) la \\(x_t\\) depende s√≥lo de su posici√≥n anterior (\\(x_{t-1}\\)). √âstas variables llevan la din√°mica pues son las que evolucionan con el tiempo. Por otro lado, las variables observadas, \\(y_t\\), se originan por cada \\(x_t\\) y por tanto en el diagrama √©stas son completamente explicadas por su \\(x_t\\) correspondiente.\n\n\n\n\n\nFigura¬†1: Representaci√≥n diagram√°tica de un modelo de espacio de estados. Las \\(x_t\\) son las variables que llevan la din√°mica y √©stas generan los observables \\(y_t\\). Nota que las \\(x_t\\) s√≥lo dependen de la observaci√≥n anterior.\n\n\n\n\nUn ejemplo espec√≠fico de un modelo de espacios de estados (el modelo local lineal) ocurre cuando consideramos que las variables latentes \\(x_t\\) se generan a partir de la anterior (\\(x_{t-1}\\)) m√°s un error aleatorio (i.e. forman una caminata aleatoria):\n\\[\nx_{t} = x_{t-1} + \\eta_t \\text{ con } \\eta_t \\sim \\text{Normal}(0,\\sigma_{\\eta}^2)\n\\]\nmientras que las \\(y_t\\) est√°n dadas por la \\(x_t\\) m√°s un segundo error aleatorio de medici√≥n con una distribuci√≥n igualmente normal:\n\\[\ny_t = x_t + \\epsilon_t \\text{ con } \\epsilon_t \\sim \\text{Normal}(0,\\sigma_{\\epsilon}^2)\n\\]\nEl sistema completo est√° dado por:\n\\[\n\\begin{align}\nx_t & = x_{t-1} + \\eta_t \\\\\ny_t & = x_t + \\epsilon_t\n\\end{align}\n\\tag{1}\\]\ncon \\(\\eta_t \\sim \\text{Normal}(0,\\sigma_{\\eta}^2)\\) y \\(\\epsilon_t \\sim \\text{Normal}(0,\\sigma_{\\epsilon}^2)\\).\nUna simulaci√≥n de este proceso est√° dado por la Figura¬†2:\n\n\nC√≥digo\nset.seed(475)\nntimes <- 100    #N√∫mero de simulaciones desde x0 hasta x_ntimes\n\nxinit  <- 0      #Valor inicial de x\nsigma_eta <- 1   #Varianza de eta\nsigma_eps <- 2.1 #Varianza de epsilon\n\nxt     <- rep(NA, ntimes + 1); xt[1] <- xinit\netat   <- rep(NA, ntimes)\nyt     <- rep(NA, ntimes)\nepst   <- rep(NA, ntimes)\n\nfor (tval in 1:ntimes){\n  etat[tval]     <- rnorm(1, mean = 0, sd = sigma_eta)\n  xt[tval + 1]   <- xt[tval] + etat[tval]\n  epst[tval]     <- rnorm(1, mean = 0, sd = sigma_eps)\n  yt[tval]       <- xt[tval + 1] + epst[tval]\n}\n\nmynames <- c(`xt`   = TeX(\"$x_t$\"),\n             `etat` = TeX(\"$\\\\eta_t$\"),\n             `yt`   = TeX(\"$y_t$\"),\n             `epst` = TeX(\"$\\\\epsilon_t$\"))\n  \n#Realineaci√≥n de x\ntibble(\n  time = 1:ntimes,\n  xt   = xt[2:(ntimes + 1)],\n  yt   = yt, \n  epst = epst,\n  etat = etat,\n) %>%\n  pivot_longer(cols = xt:etat) %>%\n  mutate(name = factor(name, levels = names(mynames), \n                       labels = mynames, ordered = T)) %>%\n  ggplot() +\n  geom_line(aes(x = time, y = value, color = name)) +\n  geom_point(aes(x = time, y = value, color = name), size = 1) +\n  geom_point(aes(x = time, y = value), color = \"white\", size = 0.25) +\n  facet_wrap(~name, labeller = label_parsed) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    axis.text.y     = element_blank(),\n    axis.ticks.y    = element_blank(),\n    plot.title      = element_text(size = 16, color = \"#0077a1\", \n                                   face = \"bold\", hjust = 0.5),\n    plot.subtitle   = element_text(size = 12, face = \"italic\",\n                                 color = \"gray25\", hjust = 0.5)\n  ) +\n  scale_color_manual(\"\", values = c(\"#1b7385\",\"#3076b8\", \"#a662bd\",\"#f53d7a\")) +\n  labs(\n    x        = \"\\nTiempo (t)\",\n    y        = \"\",\n    title    = \"Simulaciones de un modelo a nivel local\",\n    subtitle = \"Local level model\",\n    caption  = \"@RodZepeda\"\n  ) \n\n\n\n\n\nFigura¬†2: Simulaci√≥n del modelo de espacios de estados lineal dado por \\(x_t = x_{t-1} + \\eta_t\\) y \\(y_t = x_t + \\epsilon_t\\)\n\n\n\n\nEn general, la relaci√≥n entre las variables observadas y latentes no tiene por qu√© ser lineal como en la ecuaci√≥n¬†1 y podemos denotar un modelo de espacios de estados como:\n\\[\n\\begin{align}\nx_t & = f(x_{t-1}, \\eta_t), \\\\\ny_t & = h(x_t, \\epsilon_t),\n\\end{align}\n\\tag{2}\\]\ncon \\(\\eta_t\\), \\(\\epsilon_t\\) los correspondientes ‚Äúruidos‚Äù del sistema y de medici√≥n (\\(\\{\\eta_t\\}_{t\\geq0}\\) y \\(\\{\\epsilon_t\\}_{t\\geq0}\\) son colecciones de variables aleatorias mutuamente independientes). En general tanto \\(f\\) como \\(h\\) son desconocidas y no lineales.1\n\n\nPropiedades probabil√≠sticas\nEn t√©rminos de probabilidad el sistema propone un sistema markoviano (nota que \\(x_t\\) s√≥lo depende de \\(x_{t-1}\\)) que puede escribirse como sigue:\n\\[\n\\begin{align}\nx_t & \\sim p(x_{t}|x_{t-1}), \\\\\ny_t & \\sim p(y_t | x_t),\n\\end{align}\n\\tag{3}\\]\ncon \\(t\\geq 1\\). A \\(p(x_{t}|x_{t-1})\\) se le conoce como el modelo din√°mico mientras que \\(p(y_t | x_t)\\) corresponde al modelo de medici√≥n. Por definici√≥n (y un poco por inspiraci√≥n del diagrama) se cumple la propiedad de Markov (discreta) para \\(x_t\\):\n\\[\np(x_t | x_{0:t‚àí1}, y_{1:t‚àí1}) = p(x_t | x_{t‚àí1}),\n\\tag{4}\\]\nas√≠ como la independencia condicional de las observaciones:\n\\[\np(y_t | x_{0:t}, y_{1:t‚àí1}) = p(y_t | x_{t}).\n\\]\nEn estas ecuaciones, la notaci√≥n \\(v_{t-k:t+\\ell}\\) para \\(k,\\ell\\) n√∫meros naturales representa un vector con entradas de la colecci√≥n \\(\\{v_t\\}_{t\\geq 0}\\) tomadas desde \\(v_{t-k}\\) hasta \\(v_{t + \\ell}\\):\n\\[\nx_{t-k:t+\\ell} = (x_{t-k}, x_{t-k + 1}, \\dots, x_{t + \\ell - 1}, x_{t+ \\ell})^T.\n\\]\n\n\n\n\n\n\nNota\n\n\n\nEl objetivo de este documento es generar mecanismos de inferencia bayesiana a fin de aproximar dicho sistema infiriendo tanto \\(f\\) como \\(h\\) (o aproximaciones lineales \\(F\\) y \\(H\\)) a partir de una colecci√≥n finita datos observados \\(\\{y_t\\}_{t\\geq 0}\\).\n\n\n\n\n\n\n\nNotas\n\n\nA√∫n m√°s general, tanto \\(f\\) como \\(h\\) podr√≠an ser funciones que dependieran expl√≠citamente del tiempo: \\(x_t = f_t(x_{t-1}, \\eta_t)\\) y \\(y_t = h_t(x_t,\\epsilon_t)\\). No considerar√© este caso pues se puede trabajar con una variable \\(x_t\\) ampliada dada por \\(x^{\\circ}_t := (t, x_t)^T\\)‚Ü©Ô∏é"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Statisticats üê±",
    "section": "",
    "text": "modelos de espacios de estados / state space models\n\n\nestad√≠stica / statistics\n\n\nseries de tiempo / time series\n\n\nbayes\n\n\nespa√±ol / Spanish\n\n\n\n\nEn esta entrada discutimos la definici√≥n de un modelo de espacio de estados as√≠ como algunas de sus propiedades matem√°ticas Finalmente utilizamos dichas propiedades para resolver anal√≠ticamente los tres problemas principales que abordan estos modelos: filtrado, suavizamiento y predicci√≥n.\n\n\n\n\n\n\nOct 8, 2022\n\n\nRodrigo Zepeda-Tello\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About | Acerca de",
    "section": "",
    "text": "Applied mathematician. I spend my time modelling (but with math). Some years ago I became a statistician by mistake: haven‚Äôt been able to leave the club since."
  },
  {
    "objectID": "about.html#espa√±ol",
    "href": "about.html#espa√±ol",
    "title": "About | Acerca de",
    "section": "Espa√±ol:",
    "text": "Espa√±ol:\nMatem√°tico aplicado. Me la vivo modelando (pero con matem√°ticas). Hace algunos a√±os me convert√≠ en un estad√≠stico por error: no he podido salir de este club desde entonces."
  },
  {
    "objectID": "posts/state-space-models-1/index.html#filtro-de-kalman",
    "href": "posts/state-space-models-1/index.html#filtro-de-kalman",
    "title": "Modelos de Espacios de Estados",
    "section": "Filtro de Kalman",
    "text": "Filtro de Kalman"
  },
  {
    "objectID": "posts/state-space-models-1/index.html#impacto-causal-causalimpact",
    "href": "posts/state-space-models-1/index.html#impacto-causal-causalimpact",
    "title": "Modelos de Espacios de Estados",
    "section": "Impacto causal (CausalImpact)",
    "text": "Impacto causal (CausalImpact)"
  },
  {
    "objectID": "posts/state-space-models-1/index.html#sistemas-din√°micos-lineales",
    "href": "posts/state-space-models-1/index.html#sistemas-din√°micos-lineales",
    "title": "Modelos de Espacios de Estados",
    "section": "Sistemas din√°micos lineales",
    "text": "Sistemas din√°micos lineales\n\n\n\n\n\n\n\nNote\n\n\n\nEl objetivo de este documento es generar mecanismos de inferencia bayesiana a fin de aproximar dicho sistema infiriendo tanto \\(f\\) como \\(h\\) (o aproximaciones lineales \\(F\\) y \\(H\\)) a partir de una colecci√≥n finita datos observados \\(\\{y_t\\}_{t\\geq 0}\\)."
  },
  {
    "objectID": "posts/state-space-models-1/index.html#hola-1",
    "href": "posts/state-space-models-1/index.html#hola-1",
    "title": "Modelos de Espacios de Estados",
    "section": "Hola",
    "text": "Hola\n\n\n\n\n\n\n\nNota\n\n\n\nEl objetivo de este documento es generar mecanismos de inferencia bayesiana a fin de aproximar dicho sistema infiriendo tanto \\(f\\) como \\(h\\) (o aproximaciones lineales \\(F\\) y \\(H\\)) a partir de una colecci√≥n finita datos observados \\(\\{y_t\\}_{t\\geq 0}\\)."
  },
  {
    "objectID": "posts/state-space-models-1/index.html#introducci√≥n",
    "href": "posts/state-space-models-1/index.html#introducci√≥n",
    "title": "Modelos de Espacios de Estados",
    "section": "Introducci√≥n",
    "text": "Introducci√≥n\nUn modelo de espacios de estados es un sistema que evoluciona con el tiempo compuesto por dos variables:\n\nUna variable observada \\(y_t\\) que representa las mediciones realizadas al sistema al tiempo \\(t\\).\nUna variable latente (o escondida) \\(x_t\\) que es la que en realidad lleva la din√°mica.\n\n\n\n\n\n\n\nNota\n\n\n\nA lo largo de estas notas consideraremos que el sub√≠ndice \\(t\\) es un n√∫mero entero mayor o igual a cero (i.e. discreto).\n\n\nSi, por ejemplo, desde tierra observamos un avi√≥n navegar entre las nubes \\(y_t\\) ser√≠a la posici√≥n del avi√≥n al tiempo \\(t\\) (desde nuestra perspectiva) y \\(x_t\\) ser√≠a la instrucci√≥n arrojada por el piloto que vuela el avi√≥n (al tiempo \\(t\\)). Al piloto \\(x_t\\) no lo vemos (latente) pero es quien en realidad controla la posici√≥n observada de la aeronave \\(y_t\\).\nUna forma com√∫n de representar los modelos de espacios de estados es mediante gr√°ficas ac√≠clicas dirigidas (como en la Figura¬†1) donde podemos observar que en cada momento \\(t\\) la \\(x_t\\) depende s√≥lo de su posici√≥n anterior (\\(x_{t-1}\\)). √âstas variables llevan la din√°mica pues son las que evolucionan con el tiempo. Por otro lado, las variables observadas, \\(y_t\\), se originan por cada \\(x_t\\) y por tanto en el diagrama √©stas son completamente explicadas por su \\(x_t\\) correspondiente.\n\n\n\n\n\nFigura¬†1: Representaci√≥n diagram√°tica de un modelo de espacio de estados. Las \\(x_t\\) son las variables que llevan la din√°mica y √©stas generan los observables \\(y_t\\). Nota que las \\(x_t\\) s√≥lo dependen de la observaci√≥n anterior.\n\n\n\n\nUn ejemplo espec√≠fico de un modelo de espacios de estados (el modelo local lineal) ocurre cuando consideramos que las variables latentes \\(x_t\\) se generan a partir de la anterior (\\(x_{t-1}\\)) m√°s un error aleatorio (i.e. forman una caminata aleatoria):\n\\[\nx_{t} = x_{t-1} + \\eta_t \\text{ con } \\eta_t \\sim \\text{Normal}(0,\\sigma_{\\eta}^2)\n\\]\nmientras que las \\(y_t\\) est√°n dadas por la \\(x_t\\) m√°s un segundo error aleatorio de medici√≥n con una distribuci√≥n igualmente normal:\n\\[\ny_t = x_t + \\epsilon_t \\text{ con } \\epsilon_t \\sim \\text{Normal}(0,\\sigma_{\\epsilon}^2)\n\\]\nEl sistema completo est√° dado por:\n\\[\n\\begin{align}\nx_t & = x_{t-1} + \\eta_t \\\\\ny_t & = x_t + \\epsilon_t\n\\end{align}\n\\tag{1}\\]\ncon \\(\\eta_t \\sim \\text{Normal}(0,\\sigma_{\\eta}^2)\\) y \\(\\epsilon_t \\sim \\text{Normal}(0,\\sigma_{\\epsilon}^2)\\).\nUna simulaci√≥n de este proceso est√° dado por la Figura¬†2:\n\n\nC√≥digo\nset.seed(475)\nntimes <- 100    #N√∫mero de simulaciones desde x0 hasta x_ntimes\n\nxinit  <- 0      #Valor inicial de x\nsigma_eta <- 1   #Varianza de eta\nsigma_eps <- 2.1 #Varianza de epsilon\n\nxt     <- rep(NA, ntimes + 1); xt[1] <- xinit\netat   <- rep(NA, ntimes)\nyt     <- rep(NA, ntimes)\nepst   <- rep(NA, ntimes)\n\nfor (tval in 1:ntimes){\n  etat[tval]     <- rnorm(1, mean = 0, sd = sigma_eta)\n  xt[tval + 1]   <- xt[tval] + etat[tval]\n  epst[tval]     <- rnorm(1, mean = 0, sd = sigma_eps)\n  yt[tval]       <- xt[tval + 1] + epst[tval]\n}\n\nmynames <- c(`xt`   = TeX(\"$x_t$\"),\n             `etat` = TeX(\"$\\\\eta_t$\"),\n             `yt`   = TeX(\"$y_t$\"),\n             `epst` = TeX(\"$\\\\epsilon_t$\"))\n  \n#Realineaci√≥n de x\ntibble(\n  time = 1:ntimes,\n  xt   = xt[2:(ntimes + 1)],\n  yt   = yt, \n  epst = epst,\n  etat = etat,\n) %>%\n  pivot_longer(cols = xt:etat) %>%\n  mutate(name = factor(name, levels = names(mynames), \n                       labels = mynames, ordered = T)) %>%\n  ggplot() +\n  geom_line(aes(x = time, y = value, color = name)) +\n  geom_point(aes(x = time, y = value, color = name), size = 1) +\n  geom_point(aes(x = time, y = value), color = \"white\", size = 0.25) +\n  facet_wrap(~name, labeller = label_parsed) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    axis.text.y     = element_blank(),\n    axis.ticks.y    = element_blank(),\n    plot.title      = element_text(size = 16, color = \"#0077a1\", \n                                   face = \"bold\", hjust = 0.5),\n    plot.subtitle   = element_text(size = 12, face = \"italic\",\n                                 color = \"gray25\", hjust = 0.5)\n  ) +\n  scale_color_manual(\"\", values = c(\"#1b7385\",\"#3076b8\", \"#a662bd\",\"#f53d7a\")) +\n  labs(\n    x        = \"\\nTiempo (t)\",\n    y        = \"\",\n    title    = \"Simulaciones de un modelo a nivel local\",\n    subtitle = \"Local level model\",\n    caption  = \"@RodZepeda\"\n  ) \n\n\n\n\n\nFigura¬†2: Simulaci√≥n del modelo de espacios de estados lineal dado por \\(x_t = x_{t-1} + \\eta_t\\) y \\(y_t = x_t + \\epsilon_t\\)\n\n\n\n\nEn general, la relaci√≥n entre las variables observadas y latentes no tiene por qu√© ser lineal como en la ecuaci√≥n¬†1 y podemos denotar un modelo de espacios de estados como:\n\\[\n\\begin{align}\nx_t & = f(x_{t-1}, \\eta_t), \\\\\ny_t & = h(x_t, \\epsilon_t),\n\\end{align}\n\\tag{2}\\]\ncon \\(\\eta_t\\), \\(\\epsilon_t\\) los correspondientes ‚Äúruidos‚Äù del sistema y de medici√≥n (\\(\\{\\eta_t\\}_{t\\geq0}\\) y \\(\\{\\epsilon_t\\}_{t\\geq0}\\) son colecciones de variables aleatorias mutuamente independientes). En general tanto \\(f\\) como \\(h\\) son desconocidas y no lineales.1"
  },
  {
    "objectID": "posts/state-space-models-1/index.html#propiedades-probabil√≠sticas",
    "href": "posts/state-space-models-1/index.html#propiedades-probabil√≠sticas",
    "title": "Modelos de Espacios de Estados",
    "section": "Propiedades probabil√≠sticas",
    "text": "Propiedades probabil√≠sticas\nEn t√©rminos de probabilidad el sistema propone un sistema markoviano (nota que \\(x_t\\) s√≥lo depende de \\(x_{t-1}\\)) que puede escribirse como sigue:\n\\[\n\\begin{align}\nx_t & \\sim p(x_{t}|x_{t-1}), \\\\\ny_t & \\sim p(y_t | x_t),\n\\end{align}\n\\tag{3}\\]\ncon \\(t\\geq 1\\). A \\(p(x_{t}|x_{t-1})\\) se le conoce como el modelo din√°mico mientras que \\(p(y_t | x_t)\\) corresponde al modelo de medici√≥n. Por definici√≥n (y un poco por inspiraci√≥n del diagrama) se cumple la propiedad de Markov (discreta) para los estados \\(x_t\\):\n\\[\np(x_t | x_{0:t‚àí1}, y_{1:t‚àí1}) = p(x_t | x_{t‚àí1}),\n\\tag{4}\\]\nas√≠ como la independencia condicional de las observaciones:\n\\[\np(y_t | x_{0:t}, y_{1:t‚àí1}) = p(y_t | x_{t}).\n\\tag{5}\\]\nEn estas ecuaciones, la notaci√≥n \\(v_{t-k:t+\\ell}\\) para \\(k,\\ell\\) n√∫meros naturales representa un vector con entradas de la colecci√≥n \\(\\{v_t\\}_{t\\geq 0}\\) tomadas desde \\(v_{t-k}\\) hasta \\(v_{t + \\ell}\\):\n\\[\nx_{t-k:t+\\ell} = (x_{t-k}, x_{t-k + 1}, \\dots, x_{t + \\ell - 1}, x_{t+ \\ell})^T.\n\\]\nLa distribuci√≥n conjunta de los estados al momento \\(T\\) puede obtenerse f√°cilmente a partir de Markov (la ecuaci√≥n¬†4):\n\\[\np(x_{0:T}) = p(x_0) \\prod_{t = 1}^T p(x_t|x_{t-1}).\n\\tag{6}\\]\nMientras que la independencia condicional de las observaciones implica tambi√©n un producto para el vector de estados \\(y_{1:T}\\):\n\\[\np(y_{1:T} | x_{0:T} ) = \\prod\\limits_{t = 1}^T p(y_t|x_t)\n\\tag{7}\\]\nUna simple aplicaci√≥n de bayes permite la estimaci√≥n de los estados a partir de las observaciones y la combinaci√≥n de la ecuaci√≥n¬†6 y la ecuaci√≥n¬†7:\n\\[\np(x_{0:T} | y_{1:T} ) \\propto p(y_{1:T} | x_{0:T} ) \\cdot p(x_{0:T})\n\\]\nHay tres distribuciones que son de importancia en el contexto de modelos de espacios de estados que pueden verse en la Tabla¬†1:\n\n\nTabla¬†1: Distribuciones de importancia para modelos de espacios de estados\n\n\nNombre\nDistribuci√≥n\n\n\n\n\nFiltro\n\\(p(x_t|y_{1:t})\\)\n\n\nSuavizamiento\n\\(p(x_{t-\\ell}|y_{1:t})\\) con \\(\\ell \\geq 0\\)\n\n\nPredicci√≥n\n\\(p(x_{t+\\ell}|y_{1:t})\\) con \\(\\ell \\geq 1\\)\n\n\n\n\nA continuaci√≥n derivamos las distribuciones de cada uno de estos escenarios a partir de las propiedades de los modelos de espacios de estados.\n\n\n\n\n\n\n\n\nNota\n\n\n\nEl objetivo de este documento es generar mecanismos de inferencia bayesiana a fin de aproximar dicho sistema infiriendo tanto \\(f\\) como \\(h\\) (o aproximaciones lineales \\(F\\) y \\(H\\)) a partir de una colecci√≥n finita datos observados \\(\\{y_t\\}_{t\\geq 0}\\)."
  }
]