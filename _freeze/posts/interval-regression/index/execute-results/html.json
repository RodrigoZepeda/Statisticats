{
  "hash": "09f6fc99e480b8315f187d060aca3a10",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Bayesian interval regression with `Stan`\"\ndate: \"2024-03-09\"\ncategories: [R, Stan, Bayesian, Regression, cmdstanr, statistics]\nimage: \"Interval.png\"\nlang: en\ndraft: false\nabstract: \"In this entry I discuss how to do a linear regression model when the dependent variable is represented as an interval. That is, when we only know ranges for $X$ and we know there is a linear association between $X$ and $Y$.\"\ncrossref:\n  eq-prefix: equation\nformat:\n  html:\n    fig-align: center\n    code-fold: false\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n## The problem\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Interval_raw.png){width=1500}\n:::\n:::\n\n\nConsider the following problem where we have measurements for the\nresponse variable $Y$ and interval-valued dependent $X$. As an example\nproblem we can think of $X$ as consumption levels for a nutrient (grams\nper day) and $Y$ can be an outcome (systolic blood pressure). An example\ndatabase would be as follows:\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-259e492c{}.cl-25971c38{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-25971c4c{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(153, 153, 153, 1.00);background-color:transparent;}.cl-2599f750{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2599f75a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-259a0ed4{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0ede{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0edf{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0ee8{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0ee9{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0eea{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0ef2{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0ef3{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0ef4{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0efc{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0efd{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-259a0efe{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-259e492c'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-259a0ed4\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">X</span></p></th><th class=\"cl-259a0ede\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">Y</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-259a0edf\"><p class=\"cl-2599f750\"><span class=\"cl-25971c4c\">factor</span></p></th><th class=\"cl-259a0ee8\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c4c\">numeric</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ee9\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">(1,3]</span></p></td><td class=\"cl-259a0eea\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">123.7</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ee9\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">(5,10]</span></p></td><td class=\"cl-259a0eea\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">132.6</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ee9\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">(1,3]</span></p></td><td class=\"cl-259a0eea\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">120.1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ee9\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">(3,5]</span></p></td><td class=\"cl-259a0eea\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">125.7</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ef2\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">[0,1]</span></p></td><td class=\"cl-259a0ef3\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">115.8</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ee9\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">(1,3]</span></p></td><td class=\"cl-259a0eea\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">128.2</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ee9\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">(1,3]</span></p></td><td class=\"cl-259a0eea\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">122.9</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ee9\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">(10,Inf]</span></p></td><td class=\"cl-259a0eea\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">141.5</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ee9\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">(1,3]</span></p></td><td class=\"cl-259a0eea\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">117.8</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-259a0ef4\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">[0,1]</span></p></td><td class=\"cl-259a0efc\"><p class=\"cl-2599f75a\"><span class=\"cl-25971c38\">123.8</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"2\"class=\"cl-259a0efd\"><p class=\"cl-2599f750\"><span class=\"cl-25971c38\">n: 100</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n:::\n\n\nTo solve this we'll first review the classical formulation, then the\ninterval-valued formulation and finally we'll program it in `Stan`.\n\n## Classical model\n\nA classical Bayesian linear regression model (if the complete $X$ was\nobserved) is given by: \\begin{equation}\nY|_{X = x} \\sim \\textrm{Normal}(\\beta_0 + \\beta_1 x, \\sigma^2)\n\\end{equation} with priors for the parameters: \\begin{equation}\n\\beta_0 \\sim \\textrm{Normal}(0,100), \\quad \\beta_1 \\sim \\textrm{Normal}(0,100), \\quad \\sigma \\sim \\textrm{Normal}_+(0,100).\n\\end{equation}\n\nwritten in terms of the likelihood is re presented as: \\begin{equation}\n\\begin{aligned}\n\\mathcal{L}(\\beta_0, \\beta_1, \\sigma | x, y) & \\propto p(y,x | \\beta_0,\\beta_1,\\sigma)\\cdot p(\\beta_0,\\beta_1, \\sigma) \\\\\n& \\propto p(y|x, \\beta_0,\\beta_1,\\sigma) \\cdot p(\\beta_0,\\beta_1, \\sigma)\n\\end{aligned}\n\\end{equation}\n\nThis term assumes $X$ is a constant and hence there is no need to\nspecify a prior on $X$ nor to include the term\n$p(x| \\beta_0,\\beta_1,\\sigma)$ in the likelihood. When $X$ is considered\na random variable, the distribution of $X$ (say $f_X$) is included as a\nprior and in the likelihood too:\n\n\n```{=tex}\n\\begin{equation}\nX \\sim f_ X\\quad \\text{and} \\quad Y|_{X = x} \\sim \\textrm{Normal}(\\beta_0 + \\beta_1 x, \\sigma^2) \n\\end{equation}\n```\n\nand identical priors for the parameters.\n\nThe likelihood now includes a term for $X$: \\begin{equation}\n\\begin{aligned}\n\\mathcal{L}(\\beta_0, \\beta_1, \\sigma | x, y)  & \\propto\np(y,x | \\beta_0, \\beta_1, \\sigma) \\cdot p(\\beta_0, \\beta_1, \\sigma) \\\\ \n& \\propto p(y|x, \\beta_0,\\beta_1,\\sigma) \\cdot p(x| \\beta_0,\\beta_1,\\sigma)\\cdot p(\\beta_0,\\beta_1, \\sigma).\n\\end{aligned}\n\\end{equation}\n\nUsually, $X$ is independent from $\\beta_0,\\beta_1$ and $\\sigma$ hence we\ncan write $p(x| \\beta_0,\\beta_1,\\sigma) = p(x)$:\n\n\n```{=tex}\n\\begin{equation}\\label{eqlike}\n\\mathcal{L}(\\beta_0, \\beta_1, \\sigma | x, y) \\propto p(y|x, \\beta_0,\\beta_1,\\sigma)\\cdot p(x) \\cdot p(\\beta_0,\\beta_1, \\sigma).\n\\end{equation}\n```\n\n### Programming this in Stan\n\nWe'll start with this model with a lognormal distribution for $X$ as an\nexample:\n\n\n```{=tex}\n\\begin{equation}\nX \\sim \\textrm{Lognormal}(\\mu, \\tau) \\quad \\text{and} \\quad\nY|_{X = x} \\sim \\textrm{Normal}(\\beta_0 + \\beta_1 x, \\sigma^2)\n\\end{equation}\n```\n\nand priors: \\begin{equation}\n\\beta_0 \\sim \\textrm{Normal}(0,100), \\quad \\beta_1 \\sim \\textrm{Normal}(0,100), \\quad \\sigma \\sim \\textrm{Normal}_+(0,100) \\quad \\tau \\sim \\textrm{Normal}_+(0,100).\n\\end{equation}\n\nThe stan code is given by:\n\n``` stan\ndata {\n  int<lower=1> N;       //Total sample size\n  vector<lower=0>[N] X; //Observed X-values\n  vector[N] Y;          //Observed Y-values\n}\n\nparameters {\n  //Mean parameter of X\n  real<lower=0> mu;\n  \n  //Parameters for regression\n  real beta_0;\n  real beta_1;\n  \n  //Parameters for variance\n  real<lower=0> sigma;\n  real<lower=0> tau;\n}\n\ntransformed parameters {\n  vector[N] y_mean = rep_vector(beta_0, N) + beta_1*X;\n}\n\nmodel {\n  beta_0 ~ normal(0, 100);\n  beta_1 ~ normal(0, 100);\n  sigma  ~ normal(0, 100);\n  tau    ~ normal(0, 100);\n  X      ~ lognormal(mu, tau);\n  Y      ~ normal(y_mean, sigma);\n}\n```\n\nyou can save it into a file called `regression_linear.stan` and fit the\nmodel\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Install cmdstanr from their website\n#https://mc-stan.org/cmdstanr/\nlibrary(cmdstanr)\nlibrary(tidybayes)\nset.seed(274865)\n\n#Create an example dataset\nnsamples <- 100\nbeta_0   <- 120\nbeta_1   <- 1.2\nsigma_y  <- 2\nmu_x     <- 1\ntau_x    <- 1.4\n\nexample_db <- tibble(\n  Xtrue = rlnorm(nsamples, meanlog = mu_x, sdlog = tau_x), \n  Y     = beta_0 + beta_1*Xtrue + rnorm(nsamples, sd = sigma_y)\n)\n\nstan_data <- list(\n  N = nrow(example_db),\n  X = example_db$Xtrue,\n  Y = example_db$Y\n)\n\n#Compile the model\nmodel_1 <- cmdstan_model(\"regression_linear.stan\")\n\n#And fit\nfit_model <- model_1$sample(\n   data = stan_data,\n   seed = 4275,\n   chains = 4,\n   parallel_chains = 4,\n   refresh = 0\n)\n```\n:::\n\n\nThe results are very close to the true values:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#We can then verify that the fitted values are very close to the true values\nfit_model |> \n  summarise_draws() |> \n  filter(variable %in% c(\"beta_0\",\"beta_1\",\"sigma\",\"tau\",\"mu\")) |> \n  as_flextable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-27ada1ea{}.cl-27a537c6{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-27a537da{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(153, 153, 153, 1.00);background-color:transparent;}.cl-27a97b2e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-27a97b42{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-27a9914a{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a99154{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a99172{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a9917c{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a99186{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a99187{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a99190{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a99191{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a99192{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a9919a{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a9919b{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a9919c{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991a4{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991a5{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991a6{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991a7{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991ae{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991af{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991b0{width:0.922in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991b8{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27a991b9{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-27ada1ea'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-27a9914a\"><p class=\"cl-27a97b2e\"><span class=\"cl-27a537c6\">variable</span></p></th><th class=\"cl-27a99154\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">mean</span></p></th><th class=\"cl-27a99154\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">median</span></p></th><th class=\"cl-27a99154\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">sd</span></p></th><th class=\"cl-27a99154\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">mad</span></p></th><th class=\"cl-27a99154\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">q5</span></p></th><th class=\"cl-27a99154\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">q95</span></p></th><th class=\"cl-27a99154\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">rhat</span></p></th><th class=\"cl-27a99172\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">ess_bulk</span></p></th><th class=\"cl-27a99154\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">ess_tail</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-27a9917c\"><p class=\"cl-27a97b2e\"><span class=\"cl-27a537da\">character</span></p></th><th class=\"cl-27a99186\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th><th class=\"cl-27a99186\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th><th class=\"cl-27a99186\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th><th class=\"cl-27a99186\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th><th class=\"cl-27a99186\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th><th class=\"cl-27a99186\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th><th class=\"cl-27a99186\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th><th class=\"cl-27a99187\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th><th class=\"cl-27a99186\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537da\">numeric</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27a99190\"><p class=\"cl-27a97b2e\"><span class=\"cl-27a537c6\">mu</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.7</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.7</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.1</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.1</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.5</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.0</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.0</span></p></td><td class=\"cl-27a99192\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">3,679.4</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">2,064.2</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27a9919a\"><p class=\"cl-27a97b2e\"><span class=\"cl-27a537c6\">beta_0</span></p></td><td class=\"cl-27a9919b\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">119.9</span></p></td><td class=\"cl-27a9919b\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">119.9</span></p></td><td class=\"cl-27a9919b\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.2</span></p></td><td class=\"cl-27a9919b\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.2</span></p></td><td class=\"cl-27a9919b\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">119.5</span></p></td><td class=\"cl-27a9919b\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">120.3</span></p></td><td class=\"cl-27a9919b\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.0</span></p></td><td class=\"cl-27a9919c\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">3,813.0</span></p></td><td class=\"cl-27a9919b\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">3,135.5</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27a99190\"><p class=\"cl-27a97b2e\"><span class=\"cl-27a537c6\">beta_1</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.2</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.2</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.0</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.0</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.2</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.2</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.0</span></p></td><td class=\"cl-27a99192\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">4,488.7</span></p></td><td class=\"cl-27a99191\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">2,759.6</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27a991a4\"><p class=\"cl-27a97b2e\"><span class=\"cl-27a537c6\">sigma</span></p></td><td class=\"cl-27a991a5\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">2.1</span></p></td><td class=\"cl-27a991a5\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">2.1</span></p></td><td class=\"cl-27a991a5\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.2</span></p></td><td class=\"cl-27a991a5\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.2</span></p></td><td class=\"cl-27a991a5\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.9</span></p></td><td class=\"cl-27a991a5\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">2.4</span></p></td><td class=\"cl-27a991a5\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.0</span></p></td><td class=\"cl-27a991a6\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">4,979.6</span></p></td><td class=\"cl-27a991a5\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">2,797.9</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27a991a7\"><p class=\"cl-27a97b2e\"><span class=\"cl-27a537c6\">tau</span></p></td><td class=\"cl-27a991ae\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.5</span></p></td><td class=\"cl-27a991ae\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.5</span></p></td><td class=\"cl-27a991ae\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.1</span></p></td><td class=\"cl-27a991ae\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">0.1</span></p></td><td class=\"cl-27a991ae\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.3</span></p></td><td class=\"cl-27a991ae\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.7</span></p></td><td class=\"cl-27a991ae\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">1.0</span></p></td><td class=\"cl-27a991af\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">4,420.0</span></p></td><td class=\"cl-27a991ae\"><p class=\"cl-27a97b42\"><span class=\"cl-27a537c6\">2,885.7</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"10\"class=\"cl-27a991b0\"><p class=\"cl-27a97b2e\"><span class=\"cl-27a537c6\">n: 5</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n:::\n\n\n## Interval-censored model\n\nWe now consider the case where $X$ is not observed completely but only\nthe ranges of $X$. Survival analysis theory considers three types of\nranges:\n\n-   **Right censored:** Correspond to values where we only know the\n    lower bound: $[a,\\infty]$.\n-   **Left censored:** Are intervals where only the upper bound is\n    known: $[-\\infty, b]$.\n-   **Interval censored:** Are ranges of $X$ in the shape $[a,b]$ where\n    $a,b$ are real numbers.\n\nFor our example, we'll consider the following dataset where the unknown\n`X` is in the range between `X_low` and `X_up`. So, this example is only\nfor **interval-censored** data[^1].\n\n[^1]: Extensions to right/left can be done including more `if`s and\n    using `Stan`'s [special\n    values](https://mc-stan.org/docs/functions-reference/real-valued_basic_functions.html#special-values)\n    of `positive_infinity()` and `negative_infinity()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexample_problem <- \n  tibble(Xtrue = rlnorm(nsamples, meanlog = mu_x, sdlog = tau_x), \n         Y     = beta_0 + beta_1*Xtrue + rnorm(nsamples, sd = sigma_y), \n         X_low = runif(nsamples, 0, Xtrue),\n         X_up  = Xtrue + rlnorm(nsamples, meanlog = 1, sdlog = 1)\n  ) |> \n  select(X_low, X_up, Y)\n  \nas_flextable(example_problem)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-27dac1ca{}.cl-27d42e64{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-27d42e78{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(153, 153, 153, 1.00);background-color:transparent;}.cl-27d6e532{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-27d6e53c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-27d6f842{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27d6f84c{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27d6f84d{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27d6f856{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27d6f888{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27d6f889{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-27d6f88a{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-27dac1ca'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-27d6f842\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">X_low</span></p></th><th class=\"cl-27d6f842\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">X_up</span></p></th><th class=\"cl-27d6f842\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">Y</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-27d6f84c\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e78\">numeric</span></p></th><th class=\"cl-27d6f84c\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e78\">numeric</span></p></th><th class=\"cl-27d6f84c\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e78\">numeric</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f84d\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">1.1</span></p></td><td class=\"cl-27d6f84d\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">2.0</span></p></td><td class=\"cl-27d6f84d\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">119.4</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">0.1</span></p></td><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">0.8</span></p></td><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">120.6</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">1.3</span></p></td><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">7.8</span></p></td><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">128.2</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">3.4</span></p></td><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">8.2</span></p></td><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">124.8</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f84d\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">1.6</span></p></td><td class=\"cl-27d6f84d\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">4.5</span></p></td><td class=\"cl-27d6f84d\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">123.0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">0.2</span></p></td><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">2.9</span></p></td><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">118.3</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">1.0</span></p></td><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">2.3</span></p></td><td class=\"cl-27d6f856\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">121.9</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">0.5</span></p></td><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">2.8</span></p></td><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">123.3</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">6.5</span></p></td><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">11.0</span></p></td><td class=\"cl-27d6f888\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">128.3</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-27d6f889\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">2.0</span></p></td><td class=\"cl-27d6f889\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">6.0</span></p></td><td class=\"cl-27d6f889\"><p class=\"cl-27d6e532\"><span class=\"cl-27d42e64\">122.5</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"3\"class=\"cl-27d6f88a\"><p class=\"cl-27d6e53c\"><span class=\"cl-27d42e64\">n: 100</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n:::\n\n\nIn this case, the likelihood needs to account for the fact that the\nconditional probability is now for an interval and the conditional joint\ndistribution is required:\n\n\n```{=tex}\n\\begin{equation}\n\\begin{aligned}\n\\mathcal{L}(\\beta_0, \\beta_1, \\sigma | x \\in [a,b], y) & \\propto p(y,x \\in [a,b] | \\beta_0,\\beta_1,\\sigma) \\cdot p(\\beta_0,\\beta_1, \\sigma) \\\\\n& \\propto \\left[\\int\\limits_{a}^{b} p(y | x, \\beta_0,\\beta_1,\\sigma) p(x) dx\\right] \\cdot p(\\beta_0,\\beta_1, \\sigma) \n\\end{aligned}\n\\end{equation}\n```\n\n\nwe can program this in Stan by creating this part of the likelihood\nfunction separately. Here I'm first summing the log-likelihoods and then exponentiating for numerical stability of the integration process. \n\n``` stan\nfunctions {\n  // Lognormal probability density function\n  real log_lognormal_pdf(real x, real mu_lognormal, real sigma_lognormal) {\n    //1/(1 / (x * sigma * sqrt(2 * pi())) * exp(- 0.5*((log(x) - mu)/sigma)^2)\n    \n    //Values for logarithm.\n    real log_x = log(x);\n\n    //This corresponds to log(1 / (x * sigma * sqrt(2 * pi())))\n    //The constant is removed as Bayes only requires proportionality\n    real log_normalization = -(log_x + log(sigma_lognormal));\n    \n    //Exponent of the lognormal\n    real exponent = -0.5*square((log_x - mu_lognormal) / sigma_lognormal);\n    \n    //For numerical stability sum in log-scale\n    return log_normalization + exponent;\n  }\n  \n  // Normal probability density function\n  real log_normal_pdf(real y, real mu, real sigma) {\n    //1/(1 / (sqrt(2 * pi())*sigma) * exp(- 0.5*((x - mu)/sigma)^2)\n    \n    //Normal density without the 2*pi as Bayes requires only proportionality\n    real log_normalization = -log(sigma);\n    real log_exponent      = -0.5 * square((y - mu) / sigma);\n\n    return log_normalization + log_exponent;\n  }\n  \n  real integrand_pdf(real x, real xc, array[] real theta, array[] real x_r, array[] int x_i) {\n    //Linear model\n    real mu  = theta[4] + theta[5]*x;\n    \n    //Return the exponential of the log sum\n    return exp(log_lognormal_pdf(x, theta[2], theta[3]) + log_normal_pdf(x_r[1], mu, theta[1]));\n  }\n}\n```\n\nWe then construct the likelihood in Stan (file\n`regression_interval.stan`) using the `integrate_1d` routine with a precision of $\\epsilon^{2/3}$ as suggested by the [Boost website](https://www.boost.org/doc/libs/1_73_0/libs/math/doc/html/math_toolkit/double_exponential/de_tol.html):\n\n``` stan\n#include integrand.stan\n\ndata {\n  int<lower=1> N;           //Total sample size\n  vector<lower=0>[N] X_low; //Observed lower bound for X\n  vector<lower=0>[N] X_up;  //Observed upper bound for X\n  vector[N] Y;              //Observed Y-values\n}\n\n\ntransformed data {\n  //Normalize Y to help inference process\n  real mu_Y = mean(Y);\n  real sigma_Y = sd(Y);\n  vector[N] y_centered = (Y - mu_Y)/sigma_Y;\n  \n  //Required for integration\n  array[0] int x_i;\n}\n\nparameters {\n  //Mean parameter of X\n  real<lower=0> mu;\n  \n  //Parameters for regression\n  real beta_0;\n  real beta_1;\n  \n  //Parameters for variance\n  real<lower=0> sigma;\n  real<lower=0> tau;\n}\n\nmodel {\n  beta_0 ~ normal(0, 100);\n  beta_1 ~ normal(0, 100);\n  sigma  ~ normal(0, 100);\n  tau    ~ normal(0, 100);\n  \n  //Add the likelihood for intervals\n  for (i in 1:N){\n    target += log(integrate_1d(\n      integrand_pdf, X_low[i], X_up[i], \n        {sigma, mu, tau, beta_0, beta_1}, {y_centered[i]}, x_i,\n        pow(machine_precision(), 0.25))\n    );\n  }\n}\n\ngenerated quantities {\n  real beta_0_real = sigma_Y*beta_0 + mu_Y;\n  real beta_1_real = sigma_Y*beta_1;\n  real sigma_real  = sigma_Y*sigma;\n}\n```\n\nFinally, the `R` code to infer the parameters which result good estimations of the true values. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Install cmdstanr from their website\n#https://mc-stan.org/cmdstanr/\nmodel_2 <- cmdstan_model(\"regression_interval.stan\")\n\nstan_data <- list(\n  N     = nrow(example_problem),\n  X_low = example_problem$X_low,\n  X_up  = example_problem$X_up,\n  Y     = example_problem$Y\n)\n\n#And fit\nfit_model <- model_2$sample(\n  data = stan_data,\n  seed = 4275,\n  chains = 1,\n  parallel_chains = 1,\n  #refresh = 0\n)\n\n#We can then verify that the fitted values are very close to the true values\nfit_model |> \n  summarise_draws() |> \n  filter(variable %in% c(\"beta_0_real\",\"beta_1_real\",\"sigma_real\",\"tau\",\"mu\")) |> \n  as_flextable()\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-281c19ea{}.cl-2812b7d8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2812b7e2{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(153, 153, 153, 1.00);background-color:transparent;}.cl-2815a542{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2815a556{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2815ba00{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba0a{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba0b{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba14{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba15{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba1e{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba1f{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba50{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba51{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba5a{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba5b{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba5c{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba64{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba65{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba66{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba67{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba6e{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba6f{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba78{width:1.092in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba79{width:0.829in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2815ba82{width:0.888in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-281c19ea'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-2815ba00\"><p class=\"cl-2815a542\"><span class=\"cl-2812b7d8\">variable</span></p></th><th class=\"cl-2815ba0a\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">mean</span></p></th><th class=\"cl-2815ba0a\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">median</span></p></th><th class=\"cl-2815ba0a\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">sd</span></p></th><th class=\"cl-2815ba0a\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">mad</span></p></th><th class=\"cl-2815ba0a\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">q5</span></p></th><th class=\"cl-2815ba0a\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">q95</span></p></th><th class=\"cl-2815ba0a\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">rhat</span></p></th><th class=\"cl-2815ba0b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">ess_bulk</span></p></th><th class=\"cl-2815ba0a\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">ess_tail</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-2815ba14\"><p class=\"cl-2815a542\"><span class=\"cl-2812b7e2\">character</span></p></th><th class=\"cl-2815ba15\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th><th class=\"cl-2815ba15\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th><th class=\"cl-2815ba15\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th><th class=\"cl-2815ba15\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th><th class=\"cl-2815ba15\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th><th class=\"cl-2815ba15\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th><th class=\"cl-2815ba15\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th><th class=\"cl-2815ba1e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th><th class=\"cl-2815ba15\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7e2\">numeric</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-2815ba1f\"><p class=\"cl-2815a542\"><span class=\"cl-2812b7d8\">mu</span></p></td><td class=\"cl-2815ba50\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.2</span></p></td><td class=\"cl-2815ba50\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.2</span></p></td><td class=\"cl-2815ba50\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.1</span></p></td><td class=\"cl-2815ba50\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.1</span></p></td><td class=\"cl-2815ba50\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.0</span></p></td><td class=\"cl-2815ba50\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.4</span></p></td><td class=\"cl-2815ba50\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.0</span></p></td><td class=\"cl-2815ba51\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">972.6</span></p></td><td class=\"cl-2815ba50\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">583.6</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-2815ba5a\"><p class=\"cl-2815a542\"><span class=\"cl-2812b7d8\">tau</span></p></td><td class=\"cl-2815ba5b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.1</span></p></td><td class=\"cl-2815ba5b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.1</span></p></td><td class=\"cl-2815ba5b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.1</span></p></td><td class=\"cl-2815ba5b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.1</span></p></td><td class=\"cl-2815ba5b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.9</span></p></td><td class=\"cl-2815ba5b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.2</span></p></td><td class=\"cl-2815ba5b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.0</span></p></td><td class=\"cl-2815ba5c\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1,002.1</span></p></td><td class=\"cl-2815ba5b\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">659.7</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-2815ba64\"><p class=\"cl-2815a542\"><span class=\"cl-2812b7d8\">beta_0_real</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">118.6</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">118.6</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.3</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.4</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">118.0</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">119.1</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.0</span></p></td><td class=\"cl-2815ba66\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">669.6</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">645.5</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-2815ba64\"><p class=\"cl-2815a542\"><span class=\"cl-2812b7d8\">beta_1_real</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.4</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.4</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.1</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.1</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.3</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.5</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.0</span></p></td><td class=\"cl-2815ba66\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">778.2</span></p></td><td class=\"cl-2815ba65\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">613.0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-2815ba67\"><p class=\"cl-2815a542\"><span class=\"cl-2812b7d8\">sigma_real</span></p></td><td class=\"cl-2815ba6e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.9</span></p></td><td class=\"cl-2815ba6e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.8</span></p></td><td class=\"cl-2815ba6e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.2</span></p></td><td class=\"cl-2815ba6e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">0.2</span></p></td><td class=\"cl-2815ba6e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.6</span></p></td><td class=\"cl-2815ba6e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">2.2</span></p></td><td class=\"cl-2815ba6e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1.0</span></p></td><td class=\"cl-2815ba6f\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">1,261.1</span></p></td><td class=\"cl-2815ba6e\"><p class=\"cl-2815a556\"><span class=\"cl-2812b7d8\">720.2</span></p></td></tr></tbody><tfoot><tr style=\"overflow-wrap:break-word;\"><td  colspan=\"10\"class=\"cl-2815ba78\"><p class=\"cl-2815a542\"><span class=\"cl-2812b7d8\">n: 5</span></p></td></tr></tfoot></table></div>\n```\n\n:::\n:::\n\n\nWhich, graphically, results in the following regression model:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show code for plot\"}\ndraws_model <- fit_model$draws(format = \"draws_df\")\nfor (k in 0:ceiling(max(example_problem$X_up))){\n  temp <- draws_model |> \n    mutate(X = !!k) |> \n    mutate(Y = beta_0_real + beta_1_real*X) |> \n    summarise(\n      Yval = mean(Y),\n      q025 = quantile(Y, 0.025),\n      q975 = quantile(Y, 0.975),\n    ) |> \n    mutate(\n      X = !!k\n    )\n  \n  if (k == 0){\n    results_model <- temp\n  } else {\n    results_model <- results_model |> bind_rows(temp)\n  }\n  \n}\n\nplt <- ggplot(example_problem) +\n  geom_segment(aes(x = X_low, xend = X_up, y = Y, yend = Y, \n                   color = \"Observed\", fill = \"Observed\")) +\n  geom_ribbon(aes(x = X, ymin = q025, ymax = q975, \n                  fill = \"Model\"), data = results_model, alpha = 0.25) + \n  geom_line(aes(x = X, y = Yval, color = \"Model\"), data = results_model, linewidth = 1,\n            linetype = \"dashed\") + \n  theme_minimal() +\n  labs(\n    x = \"X\",\n    y = \"Y\",\n    title = \"Interval-censored regression\"\n  ) +\n  scale_color_manual(\"Data\", values = c(\"Model\" = \"black\", \"Observed\" = \"orange\")) +\n  scale_fill_manual(\"Data\", values = c(\"Model\" = \"deepskyblue4\", \"Observed\" = \"orange\")) +\n  theme(legend.position = \"bottom\")\nggsave(\"Interval.png\", width = 6, height = 4, dpi = 500, plot = plt)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](Interval.png){width=1500}\n:::\n:::\n\n\n## Discusion\n\nThis is, of course, not the only way to do this model. A different approach would be to assume that the true $X$ restricted to the interval $[a,b]$ has a certain distribution (for example, a Uniform). I find this approach useful (for convergence) but not so intuitive for the priors. Let me know if you'd like a tutorial on this different approach. \n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}